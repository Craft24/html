Highcharts.theme={colors:['#058DC7','#50B432','#ED561B','#DDDF00','#24CBE5','#64E572','#FF9655','#FFF263','#6AF9C4',"#514F78","#42A07B","#9B5E4A","#72727F","#1F949A","#82914E","#86777F","#DDDF0D","#55BF3B","#DF5353","#aaeeee","#ff0066","#eeaaee","#7798BF",],chart:{backgroundColor:{linearGradient:[0,0,500,500],stops:[[0,'rgb(255, 255, 255)'],[1,'rgb(240, 240, 255)']]},borderWidth:1,borderColor:'#ccc',borderRadius:2,plotBackgroundColor:'rgba(255, 255, 255, .9)',plotShadow:true,plotBorderWidth:1},title:{style:{color:'#000',font:'bold 12px "Trebuchet MS", Verdana, sans-serif'}},subtitle:{style:{color:'#666666',font:'bold 12px "Trebuchet MS", Verdana, sans-serif'}},xAxis:{gridLineWidth:1,lineColor:'#000',tickColor:'#000',labels:{style:{color:'#000',font:'11px Trebuchet MS, Verdana, sans-serif'}},title:{style:{color:'#333',fontWeight:'bold',fontSize:'12px',fontFamily:'Trebuchet MS, Verdana, sans-serif'}}},legend:{itemStyle:{font:'9pt Trebuchet MS, Verdana, sans-serif',color:'black'},itemHoverStyle:{color:'#039'},itemHiddenStyle:{color:'gray'}},labels:{style:{color:'#99b'}}};

var highchartsOptions = Highcharts.setOptions(Highcharts.theme);

function set_chart_(type){$("#chart_buttons a").removeClass("chart_select");$("#chart_"+type).addClass("chart_select");if(type!="table"){if($("#chart_f_re").val()=="2"){var x_list="",y_list="",chart_x_list_arr=$("#chart_x_filed_list").val().split("、");for(var i=0;i<json_list.field_name_list.length;i++){var field_name=json_list.field_name_list[i],is_x=0;for(var k=0;k<chart_x_list_arr.length;k++){var chart_x=chart_x_list_arr[k];if(chart_x==field_name){is_x=1}}if(i==0){checked="checked"}else{checked=""}if(is_x==0){y_list+="<li title='"+field_name+"'><input name='chart_field_y' id='chart_field_y_"+field_name+"' type='checkbox' value='"+field_name+"'/> <label for='chart_field_y_"+field_name+"'>"+field_name+"</label></li>"}else{x_list+="<li title='"+field_name+"'><input name='chart_field_x' "+checked+" id='chart_field_x_"+field_name+"' type='checkbox' value='"+field_name+"'/> <label for='chart_field_x_"+field_name+"'>"+field_name+"</label></li>"}}$("#chart_y_list li,#chart_x_list li").remove();$("#chart_y_list").append(y_list);$("#chart_x_list").append(x_list)}$("input[name=chart_field_y]").click(function(){var chart_f_count=$('input[name="chart_field_y"]:checked').size();$("#chart_tip").html("");if($("#chart_pie").hasClass("chart_select")==true&&chart_f_count>1){$('input[name="chart_field_y"]').each(function(){$(this).attr("checked",false).parent().children(1).removeClass("blue")});$(this).attr("checked",true).parent().children(1).addClass("blue");$("#chart_tip").html("饼形图只能选择一项图例")}else{if(this.checked==true){$(this).parent().children(1).addClass("blue")}else{$(this).parent().children(1).removeClass("blue")}}});$("input[name=chart_field_x]").click(function(){if(this.checked==true){$(this).parent().children(1).addClass("blue")}else{$(this).parent().children(1).removeClass("blue")}});$("#chart_f_list").fadeIn();goto_anchor("chart_f_list");if($("#chart_pie").hasClass("chart_select")==true){$("#is_datalab").attr("checked",true);$("#chart_tip").html("饼形图只能选择一项图例");$('input[name="chart_field_y"]').each(function(){$(this).attr("checked",false).parent().children(1).removeClass("blue")})}else{$("#chart_tip").html("")}$("#chart_f_re").val("1")}else{$("#chart_con,#chart_f_list").hide()}}

function d_table_h(){$("table.dataTable tbody tr").removeClass().hover(function(){$(this).addClass("over")},function(){$(this).removeClass("over")});$("table.dataTable tbody tr:odd").addClass("alt");};
      
function get_chart_data(chart_title){var chart_f_y_count=$('input[name="chart_field_y"]:checked').size(),chart_f_x_count=$('input[name="chart_field_x"]:checked').size();if(chart_f_x_count<1||chart_f_x_count==undefined){$("#chart_tip").html("请选择分类项(X轴)");$("#chart_c_x_line").removeClass("blue").addClass("red");setTimeout('$("#chart_c_x_line").removeClass("red").addClass("blue")',3000);return false}else if(chart_f_y_count<1||chart_f_y_count==undefined){$("#chart_tip").html("请选择图例项(Y轴)");$("#chart_c_y_line").removeClass("blue").addClass("red");setTimeout('$("#chart_c_y_line").removeClass("red").addClass("blue")',3000);return false}var chart_opt="";chart_opt={chart:{renderTo:'chart_con',zoomType:'xy',marginTop:30},title:{text:chart_title,style:{color:'#666',fontSize:'12px',lineHeight:'14px'}},xAxis:{categories:[],labels:{rotation:-45,align:'right'},style:{fontSize:"10px"}},yAxis:[{labels:{formatter:function(){return this.value+'%'},style:{color:'#89A54E'}},title:{text:'比例',style:{color:'#89A54E'}},opposite:true},{gridLineWidth:0,title:{text:'数量',style:{color:'#4572A7'}},labels:{formatter:function(){return this.value+''},style:{color:'#4572A7'}}}],tooltip:{formatter:function(){var series_name=this.series.name,unit_etc="";if(series_name.lastIndexOf("率")>0){unit_etc="%"}else{if(series_name.lastIndexOf("分")>0){unit_etc="分"}else if(series_name.lastIndexOf("秒")>0){unit_etc="秒"}else if(series_name.lastIndexOf("时")>0||series_name.lastIndexOf("时长")>0){unit_etc="分/秒"}}if(chart_type=="pie"){return'<span style="color:'+this.point.color+'">'+this.point.name+"</span>：<strong>"+this.y+'</strong> '+unit_etc+"<br/><span style='color:"+this.point.color+"'>比率：</span><strong>"+Highcharts.numberFormat(this.percentage,2)+"</strong> %"}else{return''+this.x+' <br/> <span style="color:'+this.series.color+'">'+this.series.name+"</span>：<strong>"+this.y+'</strong> '+unit_etc}}},plotOptions:{column:{dataLabels:{enabled:false},enableMouseTracking:true},bar:{dataLabels:{enabled:false},enableMouseTracking:true},spline:{dataLabels:{enabled:false},enableMouseTracking:true},pie:{enabled:true,allowPointSelect:true,cursor:'pointer',showInLegend:true,dataLabels:{enabled:true,connectorColor:'#999',style:{fontSize:'10px'},formatter:function(){return'<strong>'+this.point.name+'</strong>: '+Highcharts.numberFormat(this.percentage,2)+' %'}}}},legend:{layout:'horizontal',backgroundColor:'#ffc',shadow:true},series:[]};var field_x=[];$("input[name=chart_field_x]:checked").each(function(){field_x.push($(this).val())});var field_y=[],seriesOptions_=[];var series_arr=[],unit_arr=[],f_y_name="",unit_etc="",chart_type=$("#chart_buttons a.chart_select").attr("ch_type"),no_=0,yes_=0;if($("#is_datalab").is(":checked")==true){eval("chart_opt.plotOptions."+chart_type+".dataLabels.enabled=true")}$("input[name=chart_field_y]:checked").each(function(i){var key=$(this).val();field_y.push(key);if(key.lastIndexOf("率")>0){yes_+=1;y_x=0}else if(chart_type=="spline"){y_x=1}else{no_+=1;y_x=1}if(yes_>0&&no_>0){chart_type="spline"}if(chart_type!="pie"){chart_opt.series.push({name:key,type:chart_type,yAxis:y_x,data:[]})}});if(chart_type=="pie"){chart_opt.series.push({type:"pie",data:[]})}var cate_x="",cate_y_arr={},cate_x_arr=[];$.each(json_list.datalist,function(index,con){cate_x="";$.each(con,function(key,value){key_v=(value==null)?'':value.replace("%","");for(var i=0;i<field_x.length;i++){if(key==field_x[i]){cate_x+=key_v+""}}for(var i=0;i<field_y.length;i++){if(key==field_y[i]){if(chart_type=="pie"){chart_opt.series[0].data.push({name:cate_x,y:parseFloat(key_v)})}else{chart_opt.series[i].data.push(parseFloat(key_v))}}}});cate_x_arr.push('"'+cate_x+'"');chart_opt.xAxis.categories.push(cate_x)});if(cate_x_arr.length<8){chart_opt.xAxis.labels.rotation=0}if($("#is_datalab").is(":checked")==true){eval("chart_opt.plotOptions."+chart_type+".dataLabels.enabled=true")}else{eval("chart_opt.plotOptions."+chart_type+".dataLabels.enabled=false")}$("#chart_con").show();goto_anchor("search_list");$("#chart_f_list").fadeOut();var chart=new Highcharts.Chart(chart_opt)}